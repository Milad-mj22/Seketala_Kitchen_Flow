{% extends "dashboard.html" %}
{% load static %}
{% block title %}{{ title }}{% endblock title %}
{% block content2 %}

{% load static %}
<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø´ØªØ±ÛŒØ§Ù†</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">

<div class="container mt-4">

    <h2 class="mb-4 text-center">ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø´ØªØ±ÛŒØ§Ù†</h2>

    <div class="row">
        <!-- Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¨Ø±ØªØ± -->
        <div class="col-md-6 mb-4">
            <div class="card shadow">
                <div class="card-header bg-success text-white">ğŸ† Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¨Ø±ØªØ±</div>
                <ul class="list-group list-group-flush">
                    {% for buyer in top_buyers %}
                        <li class="list-group-item">
                            {{ buyer.buyer__first_name }} {{ buyer.buyer__last_name }} - ØªØ¹Ø¯Ø§Ø¯ Ø®Ø±ÛŒØ¯: {{ buyer.total_purchases }}
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <!-- Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø­Ø¨ÙˆØ¨ Ù…Ø´ØªØ±ÛŒØ§Ù† -->
        <div class="col-md-6 mb-4">
            <div class="card shadow">
                <div class="card-header bg-info text-white">ğŸ’¡ Ø¨ÛŒØ´ØªØ±ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒâ€ŒØ´Ø¯Ù‡</div>
                <ul class="list-group list-group-flush">
                    {% for item in top_products %}
                        <li class="list-group-item">
                            {{ item.buyer__name }}: {{ item.top_product_name }} ({{ item.top_product_amount }})
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¨Ø¯ÙˆÙ† Ø®Ø±ÛŒØ¯ -->
        <div class="col-md-6 mb-4">
            <div class="card shadow">
                <div class="card-header bg-warning text-dark">ğŸ•¸ Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¨Ø¯ÙˆÙ† Ø®Ø±ÛŒØ¯</div>
                <ul class="list-group list-group-flush">
                    {% for buyer in inactive_buyers %}
                        <li class="list-group-item">
                            {{ buyer.first_name }} {{ buyer.last_name }}
                        </li>
                    {% empty %}
                        <li class="list-group-item">Ù‡Ù…Ù‡ Ù…Ø´ØªØ±ÛŒØ§Ù† Ø®Ø±ÛŒØ¯ Ø¯Ø§Ø´ØªÙ‡â€ŒØ§Ù†Ø¯.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <!-- Ù…Ø´ØªØ±ÛŒØ§Ù† ÙˆÙØ§Ø¯Ø§Ø± -->
        <div class="col-md-6 mb-4">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">â¤ï¸ Ù…Ø´ØªØ±ÛŒØ§Ù† ÙˆÙØ§Ø¯Ø§Ø±</div>
                <ul class="list-group list-group-flush">
                    {% for buyer in loyal_buyers %}
                        <li class="list-group-item">
                            {{ buyer.buyer__first_name }} {{ buyer.buyer__last_name }} - ØªØ¹Ø¯Ø§Ø¯ Ø®Ø±ÛŒØ¯: {{ buyer.total_purchases }}
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Ù†Ù…ÙˆØ¯Ø§Ø± -->
    <div class="card mt-4 shadow">
        <div class="card-header bg-dark text-white">ğŸ“ˆ Ù†Ù…ÙˆØ¯Ø§Ø± ØªØ¹Ø¯Ø§Ø¯ Ø®Ø±ÛŒØ¯ Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¨Ø±ØªØ±</div>
        <div class="card-body">
            <canvas id="buyersChart" height="100"></canvas>
        </div>
    </div>
</div>

<script>
    const ctx = document.getElementById('buyersChart').getContext('2d');
    const chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: {{ chart_labels|safe }},
            datasets: [{
                label: 'ØªØ¹Ø¯Ø§Ø¯ Ø®Ø±ÛŒØ¯',
                data: {{ chart_data|safe }},
                backgroundColor: 'rgba(54, 162, 235, 0.7)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        },
        options: {
            indexAxis: 'y',
            scales: {
                x: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'ØªØ¹Ø¯Ø§Ø¯ Ø®Ø±ÛŒØ¯'
                    }
                }
            }
        }
    });
</script>

</body>
</html>
{% endblock %}
