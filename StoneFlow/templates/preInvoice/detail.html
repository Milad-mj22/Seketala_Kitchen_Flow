{% extends "users/base.html" %}
{% block content %}
{% load custom_filters %}
{% load static %}

<style>
  .job-card {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
    padding: 30px;
    margin-top: 40px;
  }

  .job-info-row {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    border-bottom: 1px solid #e6e6e6;
  }

  .info-label {
    font-weight: bold;
    color: #555;
  }

  .info-value {
    color: #333;
  }

  .action-btns {
    margin-top: 20px;
    text-align: center;
  }
    .rtl {
    direction: rtl;
    text-align: right;
  }
</style>

<div class="container" dir="rtl">
  <div class="job-card">
    <h3 class="text-center text-primary fw-bold mb-4">ğŸ“„ Ø¬Ø²Ø¦ÛŒØ§Øª Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ±</h3>

    <div class="job-info-row">
      <div class="info-label">Ú©Ø¯ Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ±:</div>
      <div class="info-value rtl">#{{ preinvoice.id }}</div>
    </div>
    <div class="job-info-row">
      <div class="info-label">Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ:</div>
      <div class="info-value rtl">{{ preinvoice.customer }}</div>
    </div>
    <div class="job-info-row">
      <div class="info-label">ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª:</div>
      <div class="info-value rtl">{{ preinvoice.created_at|to_jalali  }}</div>
    </div>
    <div class="job-info-row">
      <div class="info-label">ØªÙˆØ¶ÛŒØ­Ø§Øª:</div>
      <div class="info-value rtl">{{ preinvoice.note|default:"-" }}</div>
    </div>

    <div class="mt-4">
      <h5 class="fw-bold text-secondary mb-3 rtl">ğŸ§¾ Ø§Ù‚Ù„Ø§Ù… Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ±:</h5>
      <div class="table-responsive">
        <table class="table table-bordered table-hover text-center align-middle">
          <thead class="table-light">
            <tr>
              <th>Ù…Ø­ØµÙˆÙ„</th>
              <th>ØªØ¹Ø¯Ø§Ø¯</th>
              <th>Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯</th>
              <th>Ù…Ø¨Ù„Øº Ú©Ù„</th>
            </tr>
          </thead>
          <tbody>
            {% for item in preinvoice.items.all %}
            <tr>
              <td>{{ item.coop.material.name }}</td>
              <td>{{ item.coop.quantity }}</td>
              <td>{{ item.unit_price|floatformat:0 }} Ø±ÛŒØ§Ù„</td>
              <td>{{ item.total_price|floatformat:0 }} Ø±ÛŒØ§Ù„</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="4">Ù‡ÛŒÚ† Ù…ÙˆØ±Ø¯ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <div class="mt-3 text-end fw-bold text-dark">
      Ø¬Ù…Ø¹ Ú©Ù„: {{ preinvoice.total_price|floatformat:0 }} Ø±ÛŒØ§Ù„
    </div>

    <div class="action-btns">
      <a href="{% url 'sell_preinvoice' preinvoice.id %}" class="btn btn-success btn-sm mx-1">ğŸ’° ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ ÙØ±ÙˆØ´</a>

      <a href="{% url 'user_preinvoices' %}" class="btn btn-secondary btn-sm mx-1">â¬…ï¸ Ø¨Ø§Ø²Ú¯Ø´Øª</a>
    </div>
  </div>
</div>

{% endblock %}
